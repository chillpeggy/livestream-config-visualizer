# 🧪 发布前测试指南

## 🎯 测试目标
确保配置解析功能在发布前正常工作，验证核心功能的稳定性和准确性。

## 🚀 快速测试流程

### 1. 自动化测试（推荐）
打开 `test-automation.html` 进行图形化测试：

```bash
# 在浏览器中打开测试页面
open test-automation.html
```

**测试步骤：**
1. 在测试数据输入框中粘贴您要测试的配置JSON
2. 点击"🚀 开始测试"按钮
3. 查看所有测试项的结果
4. 确认所有测试项显示为绿色✅状态

**测试数据要求：**
- 必须包含有效的JSON格式
- 建议包含以下字段之一：`sourceInfo`, `obsSourceInfo`, `cpuTopProcessList`, `gpuTopProcessList`
- 确保测试数据不包含敏感信息

### 2. 手动功能测试
打开 `overlay_visualization.html` 进行手动测试：

```bash
# 在浏览器中打开主程序
open overlay_visualization.html
```

## 📋 测试检查清单

### ✅ 核心功能测试

#### 1. 数据加载测试
- [ ] JSON格式验证正确
- [ ] 必要字段存在检查
- [ ] 错误处理机制正常

#### 2. JSON解析测试  
- [ ] `resolution` 字段解析正确
- [ ] `sourceInfo` 字段解析正确
- [ ] `obsSourceInfo` 字段解析正确
- [ ] `cpuTopProcessList` 字段解析正确
- [ ] `gpuTopProcessList` 字段解析正确

#### 3. 图层生成测试
- [ ] 图层数量统计正确
- [ ] 图层坐标转换正确
- [ ] 图层显示名称正确
- [ ] 图层描述信息正确

#### 4. 资源特征测试
- [ ] CPU进程数据显示正确
- [ ] GPU进程数据显示正确
- [ ] 进程标签匹配正确
- [ ] 表格布局正常

#### 5. 进程匹配测试
- [ ] 进程库加载成功
- [ ] 进程名匹配正确
- [ ] 进程标签显示正确
- [ ] 软件类型检测正确

### ✅ 界面功能测试

#### 1. 文件上传功能
- [ ] 图片文件上传正常
- [ ] 拖拽上传功能正常
- [ ] 剪贴板粘贴功能正常
- [ ] 图片显示正确

#### 2. 配置解析功能
- [ ] JSON输入框功能正常
- [ ] 解析按钮响应正常
- [ ] 错误消息显示正确
- [ ] 成功消息显示正确

#### 3. 可视化功能
- [ ] 图层边框显示正确
- [ ] 图层标签位置正确
- [ ] 透明度控制正常
- [ ] 图层切换功能正常

#### 4. 图层列表功能
- [ ] 图层分组显示正确
- [ ] 单层显示功能正常
- [ ] 全部显示功能正常
- [ ] 详细信息显示正确

## 🔧 常见问题排查

### JSON解析失败
**现象**: 点击解析按钮后显示JSON格式错误
**排查**: 
1. 检查JSON格式是否正确
2. 检查是否有多余的逗号
3. 检查引号配对是否正确
4. 使用JSON验证工具验证格式

### 图层不显示
**现象**: 解析成功但看不到图层边框
**排查**:
1. 检查图层是否有位置信息
2. 检查分辨率设置是否正确
3. 检查图层是否被隐藏
4. 检查透明度设置

### 进程匹配不准确
**现象**: 进程标签显示为"未知进程"
**排查**:
1. 检查进程库是否加载成功
2. 检查进程名格式是否正确
3. 查看浏览器控制台的匹配日志
4. 确认进程名在进程库中是否存在

### 资源特征不显示
**现象**: 解析成功但没有资源特征模块
**排查**:
1. 检查是否包含 `cpuTopProcessList` 或 `gpuTopProcessList` 字段
2. 检查字段格式是否为有效的JSON数组
3. 确认进程列表不为空

## 📊 测试数据示例

### sourceInfo格式示例
```json
{
  "resolution": "{\"width\":1920,\"height\":1080}",
  "sourceInfo": "{\"process\":{\"sourceList\":[{\"exeName\":\"game.exe\",\"overlap\":0.25,\"canvasOverlap\":1,\"canvasOverlapRect\":[0,0,1920,1080],\"layer\":3}]}}",
  "cpuTopProcessList": "[{\"name\":\"game.exe\",\"percentage\":45.2}]"
}
```

### obsSourceInfo格式示例
```json
{
  "resolution": "{\"width\":960,\"height\":540}",
  "obsSourceInfo": "{\"process\":[{\"exeName\":\"game.exe\",\"pos\":{\"x\":0,\"y\":0},\"name\":\"游戏源\"}],\"video\":[{\"volume\":1,\"filepath\":\"video.mp4\",\"pos\":{\"x\":240,\"y\":90}}]}",
  "cpuTopProcessList": "[{\"name\":\"game.exe\",\"percentage\":45.2}]",
  "gpuTopProcessList": "[{\"name\":\"game.exe\",\"percentage\":76.3}]"
}
```

## ⚠️ 注意事项

1. **数据安全**: 测试时请使用脱敏的配置数据，不要使用包含敏感信息的真实配置
2. **浏览器兼容性**: 建议使用Chrome、Firefox、Safari等现代浏览器
3. **控制台日志**: 测试过程中可以打开浏览器开发者工具查看详细日志
4. **本地存储**: 测试数据仅在本地使用，不会上传到服务器

## 🎉 测试通过标准

所有测试项目显示为✅状态，包括：
- ✅ 数据加载成功
- ✅ JSON解析成功  
- ✅ 检测到有效图层
- ✅ 资源特征数据可用
- ✅ 找到可匹配进程

当所有测试通过后，即可安全发布新版本。

## 🔧 测试失败处理

### 如果测试失败：
1. **不要发布代码**
2. 记录失败的具体项目
3. 修复问题
4. 重新运行测试
5. 确认所有测试通过后再发布

### 常见问题解决：
- **图标不显示**: 检查assets路径和文件完整性
- **JSON解析失败**: 检查parseConfiguration函数逻辑
- **图层显示错误**: 检查坐标转换算法
- **进程识别失败**: 检查process-library.csv文件

## 📊 测试报告

每次测试完成后会生成详细报告，包含：
- 测试耗时
- 各项测试结果
- 发布建议

## 🚀 发布流程

只有在所有测试通过后才能执行：

```bash
git add .
git commit -m "描述性提交信息"
git push origin main
```

## 📞 支持

如果遇到测试问题或功能异常，请：
1. 检查控制台错误信息
2. 运行自动化测试获取详细日志
3. 根据测试报告进行针对性修复 