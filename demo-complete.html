<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç›´æ’­é…ç½®å±‚çº§å¯è§†åŒ–å·¥å…· - å®Œæ•´æ¼”ç¤º</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: 'Arial', 'Microsoft YaHei', sans-serif;
            margin: 0;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        .header h1 {
            margin: 0 0 8px 0;
            font-size: 28px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .demo-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        .demo-section h2 {
            margin: 0 0 15px 0;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .test-result {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .test-case {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #e9ecef;
        }
        .test-case:last-child { border-bottom: none; }
        .process-name { font-family: 'Courier New', monospace; font-weight: bold; }
        .result-success { color: #28a745; font-weight: bold; }
        .result-error { color: #dc3545; font-weight: bold; }
        .debug-info {
            background: #f0f0f0;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .resource-table {
            width: 100%;
            border-collapse: collapse;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            table-layout: fixed;
        }
        .resource-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 2px;
            text-align: center;
            font-weight: bold;
            font-size: 13px;
            word-wrap: break-word;
            height: 40px;
            vertical-align: middle;
        }
        .resource-table td {
            padding: 8px 2px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
            background: #fff;
            font-size: 12px;
            word-wrap: break-word;
            overflow: hidden;
            height: 50px;
            vertical-align: middle;
        }
        .resource-table .process-name {
            font-family: 'Courier New', monospace;
            font-size: 11px;
            overflow: hidden;
            white-space: normal;
            word-break: break-word;
            padding: 4px 1px;
            line-height: 1.2;
        }
        .resource-table .process-percentage {
            font-weight: bold;
            color: #e74c3c;
            font-size: 12px;
        }
        .run-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            margin: 10px 5px;
        }
        .run-btn:hover { transform: translateY(-2px); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š ç›´æ’­é…ç½®å±‚çº§å¯è§†åŒ–å·¥å…· - å®Œæ•´æ¼”ç¤º</h1>
            <p>è¿›ç¨‹åº“åŒ¹é…åŠŸèƒ½æµ‹è¯• | æ”¯æŒ1500+è¿›ç¨‹è¯†åˆ« | 16ç§è¿›ç¨‹ç±»å‹æ ‡ç­¾</p>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ§ª è¿›ç¨‹åŒ¹é…æµ‹è¯•</h2>
            <button class="run-btn" onclick="runProcessTest()">è¿è¡Œè¿›ç¨‹åŒ¹é…æµ‹è¯•</button>
            <button class="run-btn" onclick="runResourceTest()">è¿è¡Œèµ„æºç‰¹å¾æµ‹è¯•</button>
            <div id="processTestResult"></div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ“‹ èµ„æºç‰¹å¾æ¼”ç¤º</h2>
            <div id="resourceFeatureResult"></div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ› è°ƒè¯•ä¿¡æ¯</h2>
            <div id="debugInfo" class="debug-info">ç­‰å¾…æµ‹è¯•è¿è¡Œ...</div>
        </div>
    </div>

    <script>
        // å†…åµŒè¿›ç¨‹åº“æ•°æ®ï¼ˆç²¾é€‰ç‰ˆæœ¬ï¼‰
        const processLibraryData = `exe,type
LeagueClientUx,æ¸¸æˆè¿›ç¨‹
dota2,æ¸¸æˆè¿›ç¨‹
chrome,æµè§ˆå™¨è¿›ç¨‹
firefox,æµè§ˆå™¨è¿›ç¨‹
obs64,ä¼´ä¾£è¿›ç¨‹
ç›´æ’­ä¼´ä¾£,ä¼´ä¾£è¿›ç¨‹
æŒ‰é”®ç²¾çµ,è‡ªåŠ¨æ“ä½œè„šæœ¬
GenshinImpact,æ¸¸æˆè¿›ç¨‹
VALORANT-Win64-Shipping,æ¸¸æˆè¿›ç¨‹
CS2,æ¸¸æˆè¿›ç¨‹
League of Legends,æ¸¸æˆè¿›ç¨‹
TslGame,æ¸¸æˆè¿›ç¨‹
crossfire,æ¸¸æˆè¿›ç¨‹
DNFM,æ¸¸æˆè¿›ç¨‹
Overwatch,æ¸¸æˆè¿›ç¨‹
WeChat,æµè§ˆå™¨è¿›ç¨‹
QQ,æµè§ˆå™¨è¿›ç¨‹
PotPlayer,è§†é¢‘æ’­æ”¾å™¨è¿›ç¨‹
VLC,è§†é¢‘æ’­æ”¾å™¨è¿›ç¨‹
ApowerMirror,æ‰‹æœºæŠ•å±è¿›ç¨‹
BlueStacks,å®‰å“æ¨¡æ‹Ÿå™¨
MuMuPlayer,å®‰å“æ¨¡æ‹Ÿå™¨
é›·ç”µæ¨¡æ‹Ÿå™¨,å®‰å“æ¨¡æ‹Ÿå™¨
æŠ–éŸ³æ»‘å—,äººæœºæ ¡éªŒä½œå¼Šè¿›ç¨‹
æ¸¸æˆå¤–æŒ‚,æ¸¸æˆå¤–æŒ‚ä½œå¼Š
ä¸Šå·å™¨,ç›—å·è¿›ç¨‹
é»‘äº§å·¥å…·,é»‘äº§è¿›ç¨‹`;

        let processLibrary = [];
        let debugOutput = '';
        
        // æ ‡ç­¾é¢œè‰²æ ·å¼é…ç½®
        const tagStyles = {
            'æ¸¸æˆè¿›ç¨‹': { background: '#40c057', color: '#000000' },
            'æµè§ˆå™¨è¿›ç¨‹': { background: '#007bff', color: '#ffffff' },
            'è§†é¢‘æ’­æ”¾å™¨è¿›ç¨‹': { background: '#6f42c1', color: '#ffffff' },
            'æ‰‹æœºæŠ•å±è¿›ç¨‹': { background: '#fd7e14', color: '#ffffff' },
            'å®‰å“æ¨¡æ‹Ÿå™¨': { background: '#20c997', color: '#ffffff' },
            'ä¸²æµä½œå¼Šè¿›ç¨‹': { background: '#dc3545', color: '#ffffff' },
            'å¼¹å¹•çˆ¬å–è¿›ç¨‹': { background: '#ffc107', color: '#000000' },
            'äººæœºæ ¡éªŒä½œå¼Šè¿›ç¨‹': { background: '#6c757d', color: '#ffffff' },
            'éŸ³é¢‘å½•åˆ¶AIäº’åŠ¨è¿›ç¨‹': { background: '#e83e8c', color: '#ffffff' },
            'è‡ªåŠ¨æ“ä½œè„šæœ¬': { background: '#795548', color: '#ffffff' },
            'æ¸¸æˆå¤–æŒ‚ä½œå¼Š': { background: '#8b0000', color: '#ffffff' },
            'ä¼´ä¾£è¿›ç¨‹': { background: '#17a2b8', color: '#ffffff' },
            'ç§æœè¿›ç¨‹': { background: '#ff5722', color: '#ffffff' },
            'ç›—å·è¿›ç¨‹': { background: '#9c27b0', color: '#ffffff' },
            'é»‘äº§è¿›ç¨‹': { background: '#212529', color: '#ffffff' },
            'éè„šæœ¬è¿›ç¨‹': { background: '#607d8b', color: '#ffffff' },
            'æœªçŸ¥è¿›ç¨‹': { background: '#adb5bd', color: '#000000' }
        };
        
        function addDebug(message) {
            debugOutput += new Date().toLocaleTimeString() + ': ' + message + '\n';
            document.getElementById('debugInfo').textContent = debugOutput;
        }
        
        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            processLibrary = [];
            
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                const values = line.split(',');
                if (values.length >= 2 && values[0].trim() && values[1].trim()) {
                    processLibrary.push({
                        exe: values[0].trim(),
                        type: values[1].trim()
                    });
                }
            }
            addDebug(`è¿›ç¨‹åº“è§£æå®Œæˆï¼Œå…± ${processLibrary.length} æ¡è®°å½•`);
        }
        
        function matchProcessType(processName) {
            if (!processName || processLibrary.length === 0) {
                return 'æœªçŸ¥è¿›ç¨‹';
            }
            
            const cleanProcessName = processName.toLowerCase().replace(/\.exe$/, '');
            addDebug(`åŒ¹é…è¿›ç¨‹: ${processName} â†’ ${cleanProcessName}`);
            
            // ç²¾ç¡®åŒ¹é…
            let match = processLibrary.find(item => 
                item.exe.toLowerCase() === processName.toLowerCase() ||
                item.exe.toLowerCase() === cleanProcessName
            );
            
            if (match) {
                addDebug(`ç²¾ç¡®åŒ¹é…æˆåŠŸ: ${match.exe} â†’ ${match.type}`);
                return match.type;
            }
            
            // æ¨¡ç³ŠåŒ¹é…
            match = processLibrary.find(item => 
                cleanProcessName.includes(item.exe.toLowerCase()) ||
                item.exe.toLowerCase().includes(cleanProcessName)
            );
            
            if (match) {
                addDebug(`æ¨¡ç³ŠåŒ¹é…æˆåŠŸ: ${match.exe} â†’ ${match.type}`);
                return match.type;
            }
            
            addDebug(`åŒ¹é…å¤±è´¥: ${processName}`);
            return 'æœªçŸ¥è¿›ç¨‹';
        }
        
        function generateTagHTML(tagType) {
            const style = tagStyles[tagType] || { background: '#6c757d', color: '#ffffff' };
            return `<span style="background: ${style.background}; color: ${style.color}; padding: 3px 5px; border-radius: 12px; font-size: 11px; font-family: 'Microsoft YaHei', sans-serif; font-weight: 500; white-space: nowrap; display: inline-block;">${tagType}</span>`;
        }
        
        function runProcessTest() {
            debugOutput = '';
            addDebug('=== å¼€å§‹è¿›ç¨‹åŒ¹é…æµ‹è¯• ===');
            
            // è§£æè¿›ç¨‹åº“
            parseCSV(processLibraryData);
            
            // æµ‹è¯•ç”¨ä¾‹
            const testCases = [
                { name: 'LeagueClientUxRender.exe', expected: 'æ¸¸æˆè¿›ç¨‹' },
                { name: 'dota2.exe', expected: 'æ¸¸æˆè¿›ç¨‹' },
                { name: 'chrome.exe', expected: 'æµè§ˆå™¨è¿›ç¨‹' },
                { name: 'obs64.exe', expected: 'ä¼´ä¾£è¿›ç¨‹' },
                { name: 'unknownprocess.exe', expected: 'æœªçŸ¥è¿›ç¨‹' }
            ];
            
            let resultHTML = '<h3>æµ‹è¯•ç»“æœ</h3>';
            let allPassed = true;
            
            testCases.forEach(testCase => {
                const result = matchProcessType(testCase.name);
                const passed = result === testCase.expected;
                if (!passed) allPassed = false;
                
                resultHTML += `
                    <div class="test-case">
                        <span class="process-name">${testCase.name}</span>
                        <span>â†’</span>
                        <span>${generateTagHTML(result)}</span>
                        <span class="${passed ? 'result-success' : 'result-error'}">
                            ${passed ? 'âœ… é€šè¿‡' : 'âŒ å¤±è´¥'}
                        </span>
                    </div>
                `;
            });
            
            resultHTML = `<div class="test-result">
                <h4 style="color: ${allPassed ? '#28a745' : '#dc3545'}">
                    ${allPassed ? 'ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼' : 'âš ï¸ éƒ¨åˆ†æµ‹è¯•å¤±è´¥'}
                </h4>
                ${resultHTML}
            </div>`;
            
            document.getElementById('processTestResult').innerHTML = resultHTML;
        }
        
        function runResourceTest() {
            addDebug('=== å¼€å§‹èµ„æºç‰¹å¾æµ‹è¯• ===');
            
            // æ¨¡æ‹Ÿèµ„æºæ•°æ® - å¢åŠ åˆ°5ä¸ªè¿›ç¨‹è¿›è¡Œæµ‹è¯•
            const mockData = {
                cpuTopProcessList: [
                    { name: 'LeagueClientUxRender.exe', percentage: 35.4 },
                    { name: 'chrome.exe', percentage: 12.8 },
                    { name: 'obs64.exe', percentage: 8.5 },
                    { name: 'discord.exe', percentage: 6.2 },
                    { name: 'steam.exe', percentage: 4.1 }
                ],
                gpuTopProcessList: [
                    { name: 'GenshinImpact.exe', percentage: 76.3 },
                    { name: 'firefox.exe', percentage: 15.7 },
                    { name: 'nvcontainer.exe', percentage: 5.2 },
                    { name: 'dwm.exe', percentage: 2.1 },
                    { name: 'explorer.exe', percentage: 0.7 }
                ]
            };
            
            // è®¡ç®—æœ€å¤§è¿›ç¨‹æ•°
            const maxProcessCount = Math.max(mockData.cpuTopProcessList.length, mockData.gpuTopProcessList.length);
            
            let tableHTML = `
                <table class="resource-table" style="table-layout: fixed;">
                    <thead>
                        <tr>
                            <th style="width: 8%;">èµ„æºç±»å‹</th>
            `;
            
            // é‡æ–°è®¾è®¡åˆ—å®½åˆ†é…ï¼šè¿›ç¨‹åå æ›´å¤šç©ºé—´ï¼Œæ ‡ç­¾å’Œå æ¯”å è¾ƒå°‘ç©ºé—´
            const processNameWidth = `${92 / maxProcessCount * 0.5}%`; // æ¯ä¸ªè¿›ç¨‹åå 50%çš„è¿›ç¨‹ç©ºé—´
            const tagWidth = `${92 / maxProcessCount * 0.3}%`; // æ¯ä¸ªæ ‡ç­¾å 30%çš„è¿›ç¨‹ç©ºé—´
            const percentageWidth = `${92 / maxProcessCount * 0.2}%`; // æ¯ä¸ªå æ¯”å 20%çš„è¿›ç¨‹ç©ºé—´
            
            for (let i = 0; i < maxProcessCount; i++) {
                tableHTML += `
                            <th style="width: ${processNameWidth};">è¿›ç¨‹${i + 1}</th>
                            <th style="width: ${tagWidth};">æ ‡ç­¾${i + 1}</th>
                            <th style="width: ${percentageWidth};">å æ¯”${i + 1}</th>
                `;
            }
            
            tableHTML += `
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            // CPUè¡Œ
            tableHTML += '<tr><td style="font-weight: bold;">CPUå ç”¨TOP</td>';
            for (let i = 0; i < maxProcessCount; i++) {
                if (i < mockData.cpuTopProcessList.length) {
                    const process = mockData.cpuTopProcessList[i];
                    const processType = matchProcessType(process.name);
                    
                    // ä¸å†æˆªæ–­è¿›ç¨‹åï¼Œå…è®¸å®Œæ•´æ˜¾ç¤ºå¹¶æ¢è¡Œ
                    const displayName = process.name;
                    
                    tableHTML += `
                        <td class="process-name" title="${process.name}">${displayName}</td>
                        <td>${generateTagHTML(processType)}</td>
                        <td class="process-percentage">${process.percentage}%</td>
                    `;
                } else {
                    tableHTML += '<td>-</td><td>-</td><td>-</td>';
                }
            }
            tableHTML += '</tr>';
            
            // GPUè¡Œ
            tableHTML += '<tr><td style="font-weight: bold;">GPUå ç”¨TOP</td>';
            for (let i = 0; i < maxProcessCount; i++) {
                if (i < mockData.gpuTopProcessList.length) {
                    const process = mockData.gpuTopProcessList[i];
                    const processType = matchProcessType(process.name);
                    
                    // ä¸å†æˆªæ–­è¿›ç¨‹åï¼Œå…è®¸å®Œæ•´æ˜¾ç¤ºå¹¶æ¢è¡Œ
                    const displayName = process.name;
                    
                    tableHTML += `
                        <td class="process-name" title="${process.name}">${displayName}</td>
                        <td>${generateTagHTML(processType)}</td>
                        <td class="process-percentage">${process.percentage}%</td>
                    `;
                } else {
                    tableHTML += '<td>-</td><td>-</td><td>-</td>';
                }
            }
            tableHTML += '</tr>';
            
            tableHTML += '</tbody></table>';
            
            document.getElementById('resourceFeatureResult').innerHTML = tableHTML;
            addDebug(`èµ„æºç‰¹å¾æµ‹è¯•å®Œæˆ - æ˜¾ç¤º${maxProcessCount}ä¸ªè¿›ç¨‹åˆ—`);
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.addEventListener('load', function() {
            setTimeout(() => {
                runProcessTest();
                setTimeout(() => runResourceTest(), 1000);
            }, 500);
        });
    </script>
</body>
</html> 