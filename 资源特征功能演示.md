# 资源特征功能演示

## 🆕 新增功能概述

为直播配置可视化工具新增了"资源特征"模块，用于展示系统资源占用情况。该模块位于解析预览图上方，以表格形式呈现CPU和GPU的TOP进程信息。

## 📊 功能特性

### 1. 资源类型支持
- **CPU占用TOP** - 显示CPU占用率最高的进程
- **GPU占用TOP** - 显示GPU占用率最高的进程

### 2. 表格结构
表格采用动态列数设计，根据进程数量自动调整：
- **第一列**：资源类型（CPU占用TOP / GPU占用TOP）
- **后续列**：每个进程对应3列（进程名、标签、占比）
- **进程限制**：CPU和GPU各最多显示前5个进程，避免表格过宽
- **列数计算**：如果CPU有5个进程，GPU有3个进程，则表格共有16列（1+5×3=16列）
- **空白处理**：进程数量少的行，后续列显示为空

| 列类型 | 说明 | 数据来源 |
|------|------|----------|
| 资源类型 | CPU占用TOP / GPU占用TOP | 固定标识 |
| 进程名N | 第N个进程的完整名称（最多5个） | `name` 字段 |
| 标签N | 第N个进程标签（预留字段） | 暂时显示 "-" |
| 占比N | 第N个进程资源占用百分比 | `percentage` 字段 + "%" |

### 3. 数据解析
- 自动解析 `cpuTopProcessList` JSON字符串
- 自动解析 `gpuTopProcessList` JSON字符串
- **限制显示前5个进程**（按原有顺序，通常为占用率排序）
- 支持容错处理，解析失败时显示友好提示

## 🎯 使用示例

### 示例配置数据
```json
{
  "cpuTopProcessList": "[{\"percentage\":7.64,\"name\":\"LeagueClientUxRender.exe\"},{\"percentage\":0.44,\"name\":\"SGuard64.exe\"},{\"percentage\":0.41,\"name\":\"MsMpEng.exe\"}]",
  "gpuTopProcessList": "[{\"percentage\":5.85,\"name\":\"LeagueClientUxRender.exe\"},{\"percentage\":2.12,\"name\":\"douyin_widget.exe\"}]",
  "sourceInfo": "{\"fullscreen\":{\"sourceList\":[{\"overlap\":0.94,\"canvasOverlap\":1,\"canvasOverlapRect\":[0,0,1279.49,720],\"layer\":2}]}}"
}
```

### 解析结果展示
解析上述配置后，资源特征模块将显示（假设CPU有3个进程，GPU有2个进程）：

| 资源类型 | 进程名1 | 标签1 | 占比1 | 进程名2 | 标签2 | 占比2 | 进程名3 | 标签3 | 占比3 |
|----------|---------|-------|-------|---------|-------|-------|---------|-------|-------|
| CPU占用TOP | LeagueClientUxRender.exe | - | 7.64% | SGuard64.exe | - | 0.44% | MsMpEng.exe | - | 0.41% |
| GPU占用TOP | LeagueClientUxRender.exe | - | 5.85% | douyin_widget.exe | - | 2.12% | - | - | - |

**说明**：
- CPU显示前3个占用最高的进程
- GPU只有2个进程，第3列为空（显示"-"）
- 表格会根据实际进程数量动态调整列数

## 🎨 界面设计

### 1. 模块布局
- **位置**: 解析预览图上方
- **样式**: 白色卡片，圆角16px，阴影效果
- **标题**: 🖥️ 资源特征
- **宽度统一**: 与标题、输入配置、解析预览等模块保持相同宽度（2200px max）

### 2. 表格样式
- **表头**: 紫蓝渐变背景，白色文字
- **表格**: 现代化设计，悬浮阴影
- **进程名**: 等宽字体，支持长名称省略显示
- **占比**: 红色高亮，突出重要数据
- **水平滚动**: 表格超宽时支持横向滚动

### 3. 响应式处理
- **有数据时**: 显示完整表格
- **无数据时**: 显示友好的空状态提示
- **解析失败时**: 自动隐藏模块
- **布局适配**: 自动适应容器宽度，保持整体界面协调

### 4. 高度统一
- **预览图容器**: 固定高度800px
- **配置图层列表**: 固定高度800px，保持视觉平衡
- **内容滚动**: 超出内容自动显示滚动条

## 🔧 技术实现

### 1. 数据解析流程
```javascript
// 1. 检测是否包含资源数据
if (data.cpuTopProcessList || data.gpuTopProcessList) {
    generateResourceFeatures(data);
    hasResourceData = true;
}

// 2. 解析JSON字符串
cpuTopProcesses = JSON.parse(data.cpuTopProcessList);
gpuTopProcesses = JSON.parse(data.gpuTopProcessList);

// 3. 计算动态列数
const maxProcessCount = Math.max(cpuTopProcesses.length, gpuTopProcesses.length);
const totalColumns = maxProcessCount * 3 + 1; // 每个进程3列 + 资源类型列

// 4. 动态生成表头
for (let i = 0; i < maxProcessCount; i++) {
    tableHTML += `<th>进程名${i + 1}</th><th>标签${i + 1}</th><th>占比${i + 1}</th>`;
}

// 5. 填充进程数据，不足的用空白列补齐
```

### 2. 界面动态更新
- 根据数据有无动态显示/隐藏模块
- 支持错误容错和友好提示
- 自动适应不同数据结构

## 📱 兼容性

### 1. 数据格式兼容
- 支持标准JSON数组格式
- 兼容字符串化的JSON数据
- 自动处理解析异常

### 2. 界面兼容
- 响应式设计，适配不同屏幕
- 与现有层级可视化功能无缝集成
- 保持统一的设计语言

## 🚀 未来扩展

### 1. 标签功能
- 预留"标签"列，支持自定义进程分类
- 可根据进程名称自动识别游戏、系统进程等

### 2. 更多资源类型
- 内存占用TOP
- 网络占用TOP
- 磁盘占用TOP

### 3. 详细信息
- 点击进程名查看详细信息
- 支持显示完整的进程列表
- 添加进程图标和描述

## 📋 更新日志

**版本 1.1.1**
- ✅ 限制进程显示数量：CPU和GPU各最多显示前5个进程
- ✅ 界面宽度统一：所有模块保持2200px最大宽度
- ✅ 高度统一：预览图和配置图层列表高度一致（800px）
- ✅ 标题更新：将"层级配置列表"改为"配置图层列表"
- ✅ 布局优化：添加水平滚动和内容溢出处理

**版本 1.1.0**
- ✅ 新增资源特征模块
- ✅ 支持CPU和GPU所有进程展示（不限于TOP1）
- ✅ 动态表格设计，根据进程数量自动调整列数
- ✅ 现代化表格样式，空白列优雅处理
- ✅ 智能数据解析和容错
- ✅ 响应式界面布局
- ✅ 与现有功能无缝集成

**表格特性**：
- 每个进程对应3列（进程名、标签、占比）
- 最多显示5个CPU进程和5个GPU进程
- 根据实际进程数动态生成列数
- 进程数量不足时，自动用空白列填充
- 界面布局统一，视觉效果协调

该功能已集成到最新版本的直播配置可视化工具中，为用户提供更全面的系统资源监控和配置分析能力。 