<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‰ªè´´æ¿ç²˜è´´åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        
        .file-upload {
            padding: 20px;
            border: 2px dashed #e9ecef;
            border-radius: 10px;
            text-align: center;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            transition: all 0.3s ease;
            position: relative;
            margin: 20px 0;
        }
        
        .file-upload:hover {
            border-color: #667eea;
            background: linear-gradient(135deg, #f0f2ff 0%, #e8ebff 100%);
        }
        
        .file-upload.paste-ready {
            border-color: #28a745;
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            box-shadow: 0 0 10px rgba(40, 167, 69, 0.3);
        }
        
        .file-upload .paste-hint {
            position: absolute;
            top: 5px;
            right: 10px;
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .file-upload.paste-ready .paste-hint {
            opacity: 1;
        }
        
        .result-image {
            max-width: 100%;
            max-height: 400px;
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        
        .message {
            padding: 10px 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 14px;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .instructions {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #28a745;
            margin-bottom: 20px;
        }
        
        .log {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ–¼ï¸ å‰ªè´´æ¿ç²˜è´´åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="instructions">
            <h3>æµ‹è¯•æ­¥éª¤ï¼š</h3>
            <ol>
                <li>å¤åˆ¶ä¸€å¼ å›¾ç‰‡åˆ°å‰ªè´´æ¿ï¼ˆæˆªå›¾ã€å¤åˆ¶å›¾ç‰‡æ–‡ä»¶ç­‰ï¼‰</li>
                <li>é¼ æ ‡æ‚¬åœåˆ°ä¸‹æ–¹çš„ä¸Šä¼ åŒºåŸŸ</li>
                <li>çœ‹åˆ°ç»¿è‰²è¾¹æ¡†å’Œ"Ctrl+V ç²˜è´´"æç¤ºåï¼ŒæŒ‰ Ctrl+V</li>
                <li>å›¾ç‰‡åº”è¯¥ç«‹å³æ˜¾ç¤ºåœ¨ä¸‹æ–¹</li>
            </ol>
        </div>
        
        <div class="file-upload" id="fileUploadArea">
            <div class="paste-hint">Ctrl+V ç²˜è´´</div>
            <p><strong>ğŸ“‹ å‰ªè´´æ¿ç²˜è´´æµ‹è¯•åŒºåŸŸ</strong></p>
            <p>é¼ æ ‡æ‚¬åœæ­¤åŒºåŸŸï¼Œç„¶åæŒ‰ Ctrl+V ç²˜è´´å›¾ç‰‡</p>
        </div>
        
        <div id="messages"></div>
        
        <div>
            <img id="resultImage" class="result-image" style="display: none;" alt="ç²˜è´´çš„å›¾ç‰‡">
        </div>
        
        <div class="log" id="logArea">
            <strong>è°ƒè¯•æ—¥å¿—ï¼š</strong><br>
        </div>
    </div>

    <script>
        const fileUploadArea = document.getElementById('fileUploadArea');
        const resultImage = document.getElementById('resultImage');
        const messagesDiv = document.getElementById('messages');
        const logArea = document.getElementById('logArea');
        let isHoveringUploadArea = false;

        function addLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            logArea.innerHTML += `[${timestamp}] ${message}<br>`;
            logArea.scrollTop = logArea.scrollHeight;
        }

        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.textContent = message;
            messagesDiv.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 5000);
        }

        // é¼ æ ‡æ‚¬åœçŠ¶æ€ç®¡ç†
        fileUploadArea.addEventListener('mouseenter', function() {
            isHoveringUploadArea = true;
            fileUploadArea.classList.add('paste-ready');
            addLog('ğŸ–±ï¸ é¼ æ ‡è¿›å…¥ä¸Šä¼ åŒºåŸŸï¼Œå‰ªè´´æ¿ç²˜è´´å·²æ¿€æ´»');
        });

        fileUploadArea.addEventListener('mouseleave', function() {
            isHoveringUploadArea = false;
            fileUploadArea.classList.remove('paste-ready');
            addLog('ğŸ–±ï¸ é¼ æ ‡ç¦»å¼€ä¸Šä¼ åŒºåŸŸï¼Œå‰ªè´´æ¿ç²˜è´´å·²ç¦ç”¨');
        });

        // å…¨å±€ç²˜è´´äº‹ä»¶ç›‘å¬
        document.addEventListener('paste', function(e) {
            addLog(`ğŸ“‹ æ£€æµ‹åˆ°ç²˜è´´äº‹ä»¶ï¼Œæ‚¬åœçŠ¶æ€: ${isHoveringUploadArea}`);
            
            // åªæœ‰åœ¨æ‚¬åœä¸Šä¼ åŒºåŸŸæ—¶æ‰å¤„ç†ç²˜è´´
            if (!isHoveringUploadArea) {
                addLog('âŒ æœªåœ¨ä¸Šä¼ åŒºåŸŸæ‚¬åœï¼Œå¿½ç•¥ç²˜è´´äº‹ä»¶');
                return;
            }

            const items = e.clipboardData.items;
            addLog(`ğŸ“‹ å‰ªè´´æ¿é¡¹ç›®æ•°é‡: ${items.length}`);
            
            let imageFile = null;

            // æŸ¥æ‰¾å‰ªè´´æ¿ä¸­çš„å›¾ç‰‡
            for (let i = 0; i < items.length; i++) {
                const item = items[i];
                addLog(`ğŸ“‹ é¡¹ç›® ${i}: ç±»å‹=${item.type}, ç§ç±»=${item.kind}`);
                if (item.type.indexOf('image') !== -1) {
                    imageFile = item.getAsFile();
                    addLog(`âœ… æ‰¾åˆ°å›¾ç‰‡æ–‡ä»¶: ${imageFile.name || 'æœªå‘½å'}, å¤§å°=${imageFile.size} bytes`);
                    break;
                }
            }

            if (imageFile) {
                e.preventDefault(); // é˜»æ­¢é»˜è®¤ç²˜è´´è¡Œä¸º
                addLog('ğŸš« é˜»æ­¢é»˜è®¤ç²˜è´´è¡Œä¸º');
                
                // æ˜¾ç¤ºç²˜è´´æˆåŠŸçš„è§†è§‰åé¦ˆ
                fileUploadArea.style.borderColor = '#28a745';
                fileUploadArea.style.background = 'linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%)';
                addLog('ğŸ¨ åº”ç”¨æˆåŠŸè§†è§‰åé¦ˆ');
                
                // è¯»å–å¹¶æ˜¾ç¤ºå›¾ç‰‡
                const reader = new FileReader();
                reader.onload = function(e) {
                    resultImage.src = e.target.result;
                    resultImage.style.display = 'block';
                    addLog('ğŸ“¸ å›¾ç‰‡è¯»å–å®Œæˆï¼Œå¼€å§‹æ˜¾ç¤º');
                    
                    // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                    showMessage('âœ… æˆåŠŸä»å‰ªè´´æ¿ç²˜è´´å›¾ç‰‡ï¼', 'success');
                    
                    // æ¢å¤åŸå§‹æ ·å¼
                    setTimeout(() => {
                        if (isHoveringUploadArea) {
                            fileUploadArea.style.borderColor = '#28a745';
                            fileUploadArea.style.background = 'linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%)';
                        } else {
                            fileUploadArea.style.borderColor = '';
                            fileUploadArea.style.background = '';
                        }
                        addLog('ğŸ¨ æ¢å¤åŸå§‹æ ·å¼');
                    }, 500);
                };
                
                reader.onerror = function() {
                    addLog('âŒ å›¾ç‰‡è¯»å–å¤±è´¥');
                    showMessage('âŒ å›¾ç‰‡è¯»å–å¤±è´¥', 'error');
                };
                
                reader.readAsDataURL(imageFile);
                addLog('ğŸ“– å¼€å§‹è¯»å–å›¾ç‰‡æ–‡ä»¶');
                
            } else {
                // å‰ªè´´æ¿ä¸­æ²¡æœ‰å›¾ç‰‡æ—¶çš„æç¤º
                if (e.clipboardData.items.length > 0) {
                    addLog('âš ï¸ å‰ªè´´æ¿ä¸­æ²¡æœ‰å›¾ç‰‡æ–‡ä»¶');
                    showMessage('âš ï¸ å‰ªè´´æ¿ä¸­æ²¡æœ‰å›¾ç‰‡ï¼Œè¯·å…ˆå¤åˆ¶å›¾ç‰‡åå†ç²˜è´´', 'error');
                } else {
                    addLog('âš ï¸ å‰ªè´´æ¿ä¸ºç©º');
                    showMessage('âš ï¸ å‰ªè´´æ¿ä¸ºç©º', 'error');
                }
            }
        });

        // é”®ç›˜å¿«æ·é”®æç¤º
        document.addEventListener('keydown', function(e) {
            if (isHoveringUploadArea && e.ctrlKey && e.key === 'v') {
                addLog('âŒ¨ï¸ æ£€æµ‹åˆ° Ctrl+V å¿«æ·é”®');
                // æ˜¾ç¤ºç²˜è´´åŠ¨ç”»æ•ˆæœ
                fileUploadArea.style.transform = 'scale(1.02)';
                setTimeout(() => {
                    fileUploadArea.style.transform = '';
                }, 150);
            }
        });

        // é¡µé¢åŠ è½½å®Œæˆæç¤º
        window.addEventListener('load', function() {
            addLog('ğŸ‰ é¡µé¢åŠ è½½å®Œæˆï¼Œå‰ªè´´æ¿åŠŸèƒ½å·²å‡†å¤‡å°±ç»ª');
            showMessage('é¡µé¢åŠ è½½å®Œæˆï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•å‰ªè´´æ¿ç²˜è´´åŠŸèƒ½', 'success');
        });
    </script>
</body>
</html> 