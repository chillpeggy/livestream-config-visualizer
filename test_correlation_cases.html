<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç›¸å…³æ€§æ£€æµ‹æµ‹è¯•</title>
    <style>
        body {
            font-family: 'Arial', 'Microsoft YaHei', sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-case {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .test-case h3 {
            color: #333;
            margin: 0 0 15px 0;
        }
        .test-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 15px 0;
        }
        .test-data {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #007bff;
        }
        .test-result {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            border-left: 4px solid #28a745;
        }
        .negative-result {
            background: #f8d7da;
            border-left-color: #dc3545;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        pre {
            white-space: pre-wrap;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <h1>ç›¸å…³æ€§æ£€æµ‹æµ‹è¯•é¡µé¢</h1>
    <p>æµ‹è¯•è¯»è¯„è®ºå’Œå›ç­”è¯„è®ºçš„æ£€æµ‹åŠŸèƒ½ï¼ŒéªŒè¯ç§°å‘¼è¯å’Œè¯­æ°”è¯è¿‡æ»¤æ•ˆæœ</p>
    
    <button onclick="testAllCases()">ğŸ” æµ‹è¯•æ‰€æœ‰æ¡ˆä¾‹</button>
    <button onclick="clearResults()">ğŸ§¹ æ¸…ç©ºç»“æœ</button>
    
    <!-- æµ‹è¯•æ¡ˆä¾‹1ï¼šè¯»è¯„è®ºæ¡ˆä¾‹ -->
    <div class="test-case">
        <h3>æµ‹è¯•æ¡ˆä¾‹1ï¼šè¯»è¯„è®ºæ£€æµ‹ - "çœ‹çœ‹è¿·å®«æ€ä¹ˆä¸ªäº‹"</h3>
        <div class="test-content">
            <div class="test-data">
                <h4>è¯„è®ºæ–‡æœ¬ï¼š</h4>
                <pre>["å°ä¿Š,çœ‹çœ‹è¿·å®«æ€ä¹ˆä¸ªäº‹,1748404172"]</pre>
            </div>
            <div class="test-data">
                <h4>ASRæ–‡æœ¬ï¼š</h4>
                <pre>"çœ‹çœ‹è¿·å®«æ€ä¹ˆä¸ªäº‹"</pre>
            </div>
        </div>
        <button onclick="testCase1()">æµ‹è¯•æ­¤æ¡ˆä¾‹</button>
        <div id="result1" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- æµ‹è¯•æ¡ˆä¾‹2ï¼šè¯»è¯„è®º+å›ç­”æ¡ˆä¾‹ -->
    <div class="test-case">
        <h3>æµ‹è¯•æ¡ˆä¾‹2ï¼šè¯»è¯„è®º+å›ç­”æ£€æµ‹ - "ä¸Šç­æ—èƒ½è¦å·…å³°æé€Ÿæœå—"</h3>
        <div class="test-content">
            <div class="test-data">
                <h4>è¯„è®ºæ–‡æœ¬ï¼š</h4>
                <pre>["å°å‹‡æ­Œ,ä¸Šç­æ—èƒ½è¦å·…å³°æé€Ÿæœå—,1748404150"]</pre>
            </div>
            <div class="test-data">
                <h4>ASRæ–‡æœ¬ï¼š</h4>
                <pre>"å°å‹‡æ­Œ,ä¸Šç­æ—èƒ½è¦å·…å³°æé€Ÿæœå—","å¯ä»¥çš„ï¼Œä¸Šç­æ—å½“ç„¶å¯ä»¥è¦å·…å³°æé€Ÿæœ"</pre>
            </div>
        </div>
        <button onclick="testCase2()">æµ‹è¯•æ­¤æ¡ˆä¾‹</button>
        <div id="result2" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- æµ‹è¯•æ¡ˆä¾‹3ï¼šè¿‡æ»¤ç§°å‘¼è¯æ•ˆæœ -->
    <div class="test-case">
        <h3>æµ‹è¯•æ¡ˆä¾‹3ï¼šç§°å‘¼è¯è¿‡æ»¤æ•ˆæœæµ‹è¯•</h3>
        <div class="test-content">
            <div class="test-data">
                <h4>è¯„è®ºæ–‡æœ¬ï¼š</h4>
                <pre>["è°¢Father,ä½ æ€ä¹ˆæ²¡æ‰“è¿·å®«ï¼Ÿ,1748404100"]</pre>
            </div>
            <div class="test-data">
                <h4>ASRæ–‡æœ¬ï¼š</h4>
                <pre>"ä½ æ€ä¹ˆæ²¡æ‰“è¿·å®«ï¼Ÿ"</pre>
            </div>
        </div>
        <button onclick="testCase3()">æµ‹è¯•æ­¤æ¡ˆä¾‹</button>
        <div id="result3" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- æµ‹è¯•æ¡ˆä¾‹4ï¼šè¯­æ°”è¯è¿‡æ»¤æ•ˆæœ -->
    <div class="test-case">
        <h3>æµ‹è¯•æ¡ˆä¾‹4ï¼šè¯­æ°”è¯è¿‡æ»¤æ•ˆæœæµ‹è¯•</h3>
        <div class="test-content">
            <div class="test-data">
                <h4>è¯„è®ºæ–‡æœ¬ï¼š</h4>
                <pre>["å¤å¤,æ–°æ–°æˆ˜ä»¤æœ‰æ²¡æœ‰å¥½çš„å•Šï¼Ÿ,1748404080"]</pre>
            </div>
            <div class="test-data">
                <h4>ASRæ–‡æœ¬ï¼š</h4>
                <pre>"æ–°æ–°æˆ˜ä»¤æœ‰æ²¡æœ‰å¥½çš„"</pre>
            </div>
        </div>
        <button onclick="testCase4()">æµ‹è¯•æ­¤æ¡ˆä¾‹</button>
        <div id="result4" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- æµ‹è¯•æ¡ˆä¾‹5ï¼šé—®ç­”å…³ç³»æ£€æµ‹ -->
    <div class="test-case">
        <h3>æµ‹è¯•æ¡ˆä¾‹5ï¼šé—®ç­”å…³ç³»æ£€æµ‹</h3>
        <div class="test-content">
            <div class="test-data">
                <h4>è¯„è®ºæ–‡æœ¬ï¼š</h4>
                <pre>["ç”¨æˆ·A,ä»€ä¹ˆæ—¶å€™æ›´æ–°æ–°ç‰ˆæœ¬ï¼Ÿ,1748404060"]</pre>
            </div>
            <div class="test-data">
                <h4>ASRæ–‡æœ¬ï¼š</h4>
                <pre>"é¢„è®¡ä¸‹å‘¨ä¸‰ä¼šæœ‰æ–°ç‰ˆæœ¬æ›´æ–°"</pre>
            </div>
        </div>
        <button onclick="testCase5()">æµ‹è¯•æ­¤æ¡ˆä¾‹</button>
        <div id="result5" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- æµ‹è¯•æ¡ˆä¾‹6ï¼šé€šç”¨ç§°å‘¼è¯è¿‡æ»¤æµ‹è¯• - å°æ° -->
    <div class="test-case">
        <h3>æµ‹è¯•æ¡ˆä¾‹6ï¼šé€šç”¨ç§°å‘¼è¯è¿‡æ»¤ - "å°æ°"</h3>
        <div class="test-content">
            <div class="test-data">
                <h4>è¯„è®ºæ–‡æœ¬ï¼š</h4>
                <pre>["å°æ°,æ¸¸æˆä»€ä¹ˆæ—¶å€™å¼€æœï¼Ÿ,1748404040"]</pre>
            </div>
            <div class="test-data">
                <h4>ASRæ–‡æœ¬ï¼š</h4>
                <pre>"æ¸¸æˆä»€ä¹ˆæ—¶å€™å¼€æœï¼Ÿ"</pre>
            </div>
        </div>
        <button onclick="testCase6()">æµ‹è¯•æ­¤æ¡ˆä¾‹</button>
        <div id="result6" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- æµ‹è¯•æ¡ˆä¾‹7ï¼šé€šç”¨ç§°å‘¼è¯è¿‡æ»¤æµ‹è¯• - æ°å“¥ -->
    <div class="test-case">
        <h3>æµ‹è¯•æ¡ˆä¾‹7ï¼šé€šç”¨ç§°å‘¼è¯è¿‡æ»¤ - "æ°å“¥"</h3>
        <div class="test-content">
            <div class="test-data">
                <h4>è¯„è®ºæ–‡æœ¬ï¼š</h4>
                <pre>["æ°å“¥,è¿™ä¸ªè£…å¤‡æ€ä¹ˆè·å¾—ï¼Ÿ,1748404020"]</pre>
            </div>
            <div class="test-data">
                <h4>ASRæ–‡æœ¬ï¼š</h4>
                <pre>"è¿™ä¸ªè£…å¤‡æ€ä¹ˆè·å¾—ï¼Ÿ"</pre>
            </div>
        </div>
        <button onclick="testCase7()">æµ‹è¯•æ­¤æ¡ˆä¾‹</button>
        <div id="result7" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- æµ‹è¯•æ¡ˆä¾‹8ï¼šå¤šç§ç§°å‘¼è¯æ··åˆæµ‹è¯• -->
    <div class="test-case">
        <h3>æµ‹è¯•æ¡ˆä¾‹8ï¼šå¤šç§ç§°å‘¼è¯æ··åˆæµ‹è¯•</h3>
        <div class="test-content">
            <div class="test-data">
                <h4>è¯„è®ºæ–‡æœ¬ï¼š</h4>
                <pre>["è€é“,å¤§ç¥,è¿™ä¸ªæŠ€èƒ½å‰å®³å—ï¼Ÿ,1748404000"]</pre>
            </div>
            <div class="test-data">
                <h4>ASRæ–‡æœ¬ï¼š</h4>
                <pre>"è¿™ä¸ªæŠ€èƒ½å‰å®³å—ï¼Ÿ"</pre>
            </div>
        </div>
        <button onclick="testCase8()">æµ‹è¯•æ­¤æ¡ˆä¾‹</button>
        <div id="result8" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- æµ‹è¯•æ¡ˆä¾‹9ï¼šå®é™…æ¡ˆä¾‹ - ASRåˆ†å¥æµ‹è¯• -->
    <div class="test-case">
        <h3>æµ‹è¯•æ¡ˆä¾‹9ï¼šå®é™…æ¡ˆä¾‹ - ASRåˆ†å¥åˆ†æ</h3>
        <div class="test-content">
            <div class="test-data">
                <h4>è¯„è®ºæ–‡æœ¬ï¼š</h4>
                <pre>["å°å‹‡æ­Œ,ä¸Šç­æ—èƒ½è¦å·…å³°æé€Ÿæœå—,1748404150"]</pre>
            </div>
            <div class="test-data">
                <h4>ASRæ–‡æœ¬ï¼ˆç©ºæ ¼åˆ†å¥ï¼‰ï¼š</h4>
                <pre>"åªè¦ç»æµä½“åšçš„å¥½å°±è¡Œè€Œä¸”äººçš„ä¸œè¥¿ä¿å€¼å•Šè¿™ä¹ˆå¤šå¹´ ä¸Šç­æ—èƒ½è¦å·…å³°æé€Ÿä½ è¿™ä¸ªä½ è¯´å·…å³°æœå‘—ä½ å¯ä»¥"</pre>
                <p style="color: #6c757d; font-size: 12px; margin-top: 5px;">
                    é¢„æœŸï¼šç³»ç»Ÿåº”è¯¥è¯†åˆ«åˆ°ååŠå¥"ä¸Šç­æ—èƒ½è¦å·…å³°æé€Ÿä½ è¿™ä¸ªä½ è¯´å·…å³°æœå‘—ä½ å¯ä»¥"ä¸è¯„è®ºç›¸å…³
                </p>
            </div>
        </div>
        <button onclick="testCase9()">æµ‹è¯•æ­¤æ¡ˆä¾‹</button>
        <div id="result9" class="test-result" style="display:none;"></div>
    </div>

    <script>
        // ä»ä¸»é¡µé¢å¤åˆ¶çš„ç›¸å…³æ€§æ£€æµ‹å‡½æ•°
        
        // è§£æASRæ–‡æœ¬ - æå–åŒå¼•å·å†…çš„å†…å®¹
        function parseAsrText(input) {
            if (!input) return [];
            
            const regex = /"([^"]+)"/g;
            const matches = [];
            let match;
            
            while ((match = regex.exec(input)) !== null) {
                matches.push(match[1].trim());
            }
            
            return matches;
        }

        // è§£æè¯„è®ºæ–‡æœ¬ - æå–è¯„è®ºå†…å®¹å’Œæ—¶é—´æˆ³
        function parseCommentText(input) {
            if (!input) return [];
            
            const comments = [];
            
            // é¦–å…ˆå°è¯•è§£æJSONæ•°ç»„æ ¼å¼
            if (input.trim().startsWith('[') && input.trim().endsWith(']')) {
                try {
                    console.log('å°è¯•è§£æJSONæ•°ç»„æ ¼å¼');
                    
                    // å¤„ç†è½¬ä¹‰çš„å¼•å·
                    let jsonStr = input.trim();
                    // å°† \" æ›¿æ¢ä¸º " 
                    jsonStr = jsonStr.replace(/\\"/g, '"');
                    
                    console.log('å¤„ç†åçš„JSONå­—ç¬¦ä¸²:', jsonStr);
                    
                    const jsonArray = JSON.parse(jsonStr);
                    console.log('è§£æçš„JSONæ•°ç»„:', jsonArray);
                    
                    jsonArray.forEach((item, index) => {
                        console.log(`å¤„ç†JSONæ•°ç»„é¡¹ ${index}:`, item);
                        
                        // æ¯ä¸ªé¡¹åº”è¯¥æ˜¯ "ç”¨æˆ·å,è¯„è®ºå†…å®¹,æ—¶é—´æˆ³" æ ¼å¼
                        const parts = item.split(',');
                        if (parts.length >= 3) {
                            const timestamp = parseInt(parts[parts.length - 1]);
                            const content = parts.slice(0, -1).join(','); // é‡æ–°ç»„åˆå†…å®¹ï¼ˆå¤„ç†è¯„è®ºä¸­å¯èƒ½åŒ…å«é€—å·çš„æƒ…å†µï¼‰
                            
                            console.log('è§£æJSONé¡¹æˆåŠŸ:', { content, timestamp });
                            
                            const time = new Date(timestamp * 1000);
                            
                            // è½¬æ¢ä¸ºåŒ—äº¬æ—¶é—´
                            const beijingTime = new Date(time.getTime() + (8 * 60 * 60 * 1000));
                            const timeString = beijingTime.toLocaleString('zh-CN', {
                                hour: '2-digit',
                                minute: '2-digit',
                                second: '2-digit'
                            });
                            
                            comments.push({
                                content: content,
                                timestamp: timestamp,
                                timeString: timeString
                            });
                        } else {
                            console.log('JSONé¡¹æ ¼å¼ä¸æ­£ç¡®:', item);
                        }
                    });
                    
                    if (comments.length > 0) {
                        console.log('JSONæ•°ç»„è§£ææˆåŠŸï¼Œå…±è§£æ', comments.length, 'æ¡è¯„è®º');
                        return comments;
                    }
                } catch (error) {
                    console.log('JSONæ•°ç»„è§£æå¤±è´¥:', error);
                }
            }
            
            return comments;
        }

        // æ¸…ç†æ–‡æœ¬ç”¨äºç›¸ä¼¼åº¦æ¯”è¾ƒ
        function cleanTextForSimilarity(text) {
            let cleanText = text;
            
            // ç§»é™¤æ ‡ç‚¹ç¬¦å·å’Œç©ºæ ¼
            cleanText = cleanText.replace(/[ï¼Œã€‚ï¼ï¼Ÿã€,.!?\s]/g, '');
            
            // ç§»é™¤ç§°å‘¼è¯ï¼ˆç”¨æˆ·åæ¨¡å¼ï¼‰
            cleanText = removeMentionWords(cleanText);
            
            // ç§»é™¤è¯­æ°”è¯
            cleanText = removeFillerWords(cleanText);
            
            return cleanText;
        }

        // ç§»é™¤ç§°å‘¼è¯ï¼ˆç”¨æˆ·åã€æ˜µç§°ç­‰ï¼‰
        function removeMentionWords(text) {
            // å¸¸è§ç§°å‘¼è¯æ¨¡å¼
            const mentionPatterns = [
                // === é€šç”¨ç§°å‘¼æ¨¡å¼ ===
                // "å°+å•å­—/åŒå­—å§“å"æ¨¡å¼ï¼šå°æ°ã€å°æ˜ã€å°æã€å°ç‹ç­‰
                /å°[a-zA-Z\u4e00-\u9fa5]{1,3}[,ï¼Œ]?/g,
                // "å§“å+å“¥/å§/å…„/å¦¹/å”/å“¥å“¥/å§å§"æ¨¡å¼ï¼šæ°å“¥ã€æ˜å“¥ã€æå§ã€ç‹å…„ç­‰
                /[a-zA-Z\u4e00-\u9fa5]{1,3}(å“¥|å§|å…„|å¦¹|å”|å“¥å“¥|å§å§|å¼Ÿ|å¼Ÿå¼Ÿ|å¦¹å¦¹)[,ï¼Œ]?/g,
                // "è€+å§“å"æ¨¡å¼ï¼šè€ç‹ã€è€æã€è€å¼ ç­‰
                /è€[a-zA-Z\u4e00-\u9fa5]{1,3}[,ï¼Œ]?/g,
                // "é˜¿+å§“å"æ¨¡å¼ï¼šé˜¿æ°ã€é˜¿æ˜ã€é˜¿å¼ºç­‰
                /é˜¿[a-zA-Z\u4e00-\u9fa5]{1,3}[,ï¼Œ]?/g,
                // è‹±æ–‡åæ¨¡å¼ï¼šJack, Tom, Mikeç­‰ï¼ˆåé¢è·Ÿé€—å·æˆ–ç»“å°¾ï¼‰
                /[A-Z][a-zA-Z]{2,}[,ï¼Œ]?/g,
                
                // === ä¸­è‹±æ–‡æ··åˆç”¨æˆ·åæ¨¡å¼ ===
                // å¤æ‚ç”¨æˆ·åï¼ˆä¸­è‹±æ–‡æ··åˆã€ç‰¹æ®Šå­—ç¬¦ï¼‰
                /[a-zA-Z0-9_\u4e00-\u9fa5]+[\u4e00-\u9fa5]*[,ï¼Œ]/g,
                
                // === é€šç”¨ç§°å‘¼ ===
                /ä¸»æ’­[,ï¼Œ]?/g,
                /è€æ¿[,ï¼Œ]?/g,
                /å…„å¼Ÿ[,ï¼Œ]?/g,
                /æœ‹å‹[,ï¼Œ]?/g,
                /å¤§ä½¬[,ï¼Œ]?/g,
                /è€å¸ˆ[,ï¼Œ]?/g,
                /å“¥ä»¬[,ï¼Œ]?/g,
                /å…„dei[,ï¼Œ]?/g,
                /å¤§ç¥[,ï¼Œ]?/g,
                /è€é“[,ï¼Œ]?/g,
                /å¤§å“¥[,ï¼Œ]?/g,
                /è€å“¥[,ï¼Œ]?/g,
                /å…„å¼Ÿä»¬[,ï¼Œ]?/g,
                /å„ä½[,ï¼Œ]?/g,
                /åŒå­¦[,ï¼Œ]?/g,
                /è€åŒå­¦[,ï¼Œ]?/g,
                /åŒå¿—[,ï¼Œ]?/g,
                /å¸ˆå‚…[,ï¼Œ]?/g,
                /è€æ¿å¨˜[,ï¼Œ]?/g,
                
                // === ç‰¹å®šç”¨æˆ·åï¼ˆä»è¯„è®ºä¸­æå–çš„å·²çŸ¥æ ¼å¼ï¼‰===
                /å°ä¿Š[,ï¼Œ]?/g,
                /è°¢Father[,ï¼Œ]?/g,
                /å°å‹‡æ­Œ[,ï¼Œ]?/g,
                /ä¸¹é˜³çœ¼é•œ[,ï¼Œ]?/g,
                /éæ’é“[,ï¼Œ]?/g,
                /å¤å¤[,ï¼Œ]?/g,
                /ä»Šå¤œä¸ä¸‹é›ª[,ï¼Œ]?/g,
                /èµ°èµ°åœåœ[,ï¼Œ]?/g,
                /ä¹åŠ«[,ï¼Œ]?/g,
                /ä¸€è¬[,ï¼Œ]?/g,
                /å¤œç©ºä¸­çš„ä¸€é¢—æ˜Ÿ[,ï¼Œ]?/g,
                /ç™½ç¾Šåº§[,ï¼Œ]?/g,
                /æ‹é›ªå…®é™Œ[,ï¼Œ]?/g,
                /ä¸åƒèŒ„å­ğŸƒ[,ï¼Œ]?/g,
                /ğŸé¢–ç«è™«ğŸ[,ï¼Œ]?/g,
                /ä¸œå±±å•ŠğŸ‚[,ï¼Œ]?/g,
                /å°æ˜å“¥[,ï¼Œ]?/g,
                /å°æ‰‹ç‰µå°ç‹—[,ï¼Œ]?/g,
                /å“¦æ©˜å­æ€•å†»[,ï¼Œ]?/g,
                /è¯¶æˆ‘å»[,ï¼Œ]?/g,
                /è¿·ç³ŠèŒ[,ï¼Œ]?/g,
                /Monter[,ï¼Œ]?/g,
                /ä¾ƒä¾ƒ[,ï¼Œ]?/g,
                /å¦™ä¸å¯è¨€[,ï¼Œ]?/g,
                /ä¸è¿‡å°”å°”[,ï¼Œ]?/g,
                /ä¸ƒå¢“å‡‰[,ï¼Œ]?/g,
                /å¾—åˆ©ğŸŒˆ[,ï¼Œ]?/g,
                /å°é¾™å”[,ï¼Œ]?/g,
                /å…±äº§ä¸»ä¹‰æ¥ç­äºº[,ï¼Œ]?/g,
                /é“å¿ƒç¨³å›ºâœ¨[,ï¼Œ]?/g,
                /GXC[,ï¼Œ]?/g,
                /å›å›[,ï¼Œ]?/g,
                /æ„å¤§å¸ˆ[,ï¼Œ]?/g,
                /å°æ°[,ï¼Œ]?/g,
                /æ°å“¥[,ï¼Œ]?/g,
                /å°æ˜[,ï¼Œ]?/g,
                /æ˜å“¥[,ï¼Œ]?/g,
                /å°æ[,ï¼Œ]?/g,
                /æå“¥[,ï¼Œ]?/g,
                /å°ç‹[,ï¼Œ]?/g,
                /ç‹å“¥[,ï¼Œ]?/g,
                /å°å¼ [,ï¼Œ]?/g,
                /å¼ å“¥[,ï¼Œ]?/g,
                /å°åˆ˜[,ï¼Œ]?/g,
                /åˆ˜å“¥[,ï¼Œ]?/g,
                /å°é™ˆ[,ï¼Œ]?/g,
                /é™ˆå“¥[,ï¼Œ]?/g,
                /å°èµµ[,ï¼Œ]?/g,
                /èµµå“¥[,ï¼Œ]?/g
            ];
            
            let result = text;
            mentionPatterns.forEach(pattern => {
                result = result.replace(pattern, '');
            });
            
            return result;
        }

        // ç§»é™¤è¯­æ°”è¯å’Œæ— æ„ä¹‰è¯
        function removeFillerWords(text) {
            const fillerWords = [
                'å•Š', 'å‘€', 'å˜›', 'å‘¢', 'å§', 'å“¦', 'å”‰', 'å—¯', 'å“',
                'é‚£ä¸ª', 'è¿™ä¸ª', 'å°±æ˜¯', 'ç„¶å', 'æ‰€ä»¥', 'å› ä¸º', 'ä½†æ˜¯',
                'ä¸è¿‡', 'è¿˜æ˜¯', 'æˆ–è€…', 'å¦‚æœ', 'è™½ç„¶', 'å¯æ˜¯', 'åªæ˜¯',
                'è€Œä¸”', 'å¦å¤–', 'æ€»ä¹‹', 'åæ­£', 'å…¶å®', 'å½“ç„¶', 'è‚¯å®š',
                'åº”è¯¥', 'å¯èƒ½', 'å¤§æ¦‚', 'ä¹Ÿè®¸', 'ä¼°è®¡', 'å·®ä¸å¤š',
                'çš„è¯', 'æ¥è¯´', 'æ–¹é¢', 'æƒ…å†µ', 'é—®é¢˜', 'ä¸œè¥¿', 'äº‹æƒ…',
                'æ—¶å€™', 'åœ°æ–¹', 'æ ·å­', 'æ„æ€', 'æ„Ÿè§‰', 'è§‰å¾—',
                'ä»–å¦ˆ', 'å°¼ç©', 'ä½ ä½ ', 'å’±è¯´', 'å’Œå’Œè¯´', '[å‘²ç‰™]', '[çœ‹]', '[æ¯”å¿ƒ]',
                'ğŸš´ğŸ»', 'âœ¨', 'ğŸƒ', 'ğŸ', 'ğŸ‚', 'ğŸŒˆ'
            ];
            
            let result = text;
            fillerWords.forEach(word => {
                const regex = new RegExp(word, 'g');
                result = result.replace(regex, '');
            });
            
            return result;
        }

        // è®¡ç®—æ–‡æœ¬ç›¸ä¼¼åº¦
        function calculateTextSimilarity(text1, text2) {
            // ç§»é™¤æ ‡ç‚¹ç¬¦å·ã€ç©ºæ ¼ã€ç§°å‘¼è¯å’Œè¯­æ°”è¯
            const clean1 = cleanTextForSimilarity(text1);
            const clean2 = cleanTextForSimilarity(text2);
            
            console.log('æ¸…ç†å‰:', text1, '|', text2);
            console.log('æ¸…ç†å:', clean1, '|', clean2);
            
            if (clean1.length === 0 || clean2.length === 0) return 0;
            
            // è®¡ç®—æœ€é•¿å…¬å…±å­åºåˆ—é•¿åº¦
            const lcs = longestCommonSubsequence(clean1, clean2);
            const similarity = (lcs * 2) / (clean1.length + clean2.length);
            
            console.log('LCSé•¿åº¦:', lcs, 'ç›¸ä¼¼åº¦:', similarity);
            
            return similarity;
        }

        // æœ€é•¿å…¬å…±å­åºåˆ—
        function longestCommonSubsequence(text1, text2) {
            const m = text1.length, n = text2.length;
            const dp = Array(m + 1).fill().map(() => Array(n + 1).fill(0));
            
            for (let i = 1; i <= m; i++) {
                for (let j = 1; j <= n; j++) {
                    if (text1[i - 1] === text2[j - 1]) {
                        dp[i][j] = dp[i - 1][j - 1] + 1;
                    } else {
                        dp[i][j] = Math.max(dp[i - 1][j], dp[i][j - 1]);
                    }
                }
            }
            
            return dp[m][n];
        }

        // æ£€æŸ¥æ˜¯å¦åœ¨è¯»è¯„è®º
        function checkReadingComment(asrText, commentText) {
            // è®¡ç®—æ–‡æœ¬ç›¸ä¼¼åº¦ï¼ˆåŸºäºå­—ç¬¦é‡å¤ï¼‰
            const similarity = calculateTextSimilarity(asrText, commentText);
            
            // é™ä½é˜ˆå€¼ï¼Œå› ä¸ºè¿‡æ»¤äº†ç§°å‘¼è¯å’Œè¯­æ°”è¯åï¼Œæœ‰æ•ˆå†…å®¹ç›¸ä¼¼åº¦æå‡
            const isReading = similarity > 0.4;
            
            return {
                isReading: isReading,
                similarity: similarity,
                reason: isReading ? `æ–‡æœ¬ç›¸ä¼¼åº¦${(similarity * 100).toFixed(1)}%ï¼Œåˆ¤æ–­ä¸ºåœ¨è¯»è¯„è®º` : `æ–‡æœ¬ç›¸ä¼¼åº¦${(similarity * 100).toFixed(1)}%ï¼Œä½äºé˜ˆå€¼40%`
            };
        }

        // åˆ†æç›¸å…³æ€§
        function analyzeCorrelation(asrTexts, commentTexts) {
            const result = {
                hasCorrelation: false,
                reasons: [],
                details: []
            };
            
            if (asrTexts.length === 0 || commentTexts.length === 0) {
                return result;
            }
            
            // å°†ASRæ–‡æœ¬æŒ‰ç©ºæ ¼åˆ†å¥ï¼Œå› ä¸ºç©ºæ ¼ä»£è¡¨æ¢è¡Œ/åˆ†å¥
            const allAsrSentences = [];
            asrTexts.forEach((asrText, originalIndex) => {
                const sentences = asrText.split(/\s+/).filter(s => s.trim().length > 0);
                sentences.forEach((sentence, sentenceIndex) => {
                    allAsrSentences.push({
                        text: sentence.trim(),
                        originalIndex: originalIndex,
                        sentenceIndex: sentenceIndex,
                        fullText: asrText
                    });
                });
            });
            
            console.log('åˆ†å¥åçš„ASRæ–‡æœ¬:', allAsrSentences);
            
            // æ£€æŸ¥æ¯ä¸ªè¯„è®ºä¸æ¯ä¸ªASRå¥å­çš„å…³ç³»
            commentTexts.forEach((comment, commentIndex) => {
                allAsrSentences.forEach((asrSentence) => {
                    // æ£€æŸ¥æ˜¯å¦åœ¨è¯»è¯„è®ºï¼ˆé«˜åº¦é‡å¤ï¼‰
                    const readingResult = checkReadingComment(asrSentence.text, comment.content);
                    if (readingResult.isReading) {
                        result.hasCorrelation = true;
                        result.reasons.push('ASRæ–‡æœ¬åœ¨è¯»è¯„è®º');
                        result.details.push({
                            type: 'reading',
                            asrText: asrSentence.text,
                            commentText: comment.content,
                            reason: readingResult.reason,
                            similarity: readingResult.similarity,
                            asrIndex: asrSentence.originalIndex,
                            asrSentenceIndex: asrSentence.sentenceIndex,
                            commentIndex: commentIndex,
                            fullAsrText: asrSentence.fullText
                        });
                        
                        console.log('å‘ç°è¯»è¯„è®ºç›¸å…³æ€§:', {
                            comment: comment.content,
                            asrSentence: asrSentence.text,
                            similarity: readingResult.similarity
                        });
                    }
                });
            });
            
            // å»é‡åŸå› 
            result.reasons = [...new Set(result.reasons)];
            
            return result;
        }

        // æµ‹è¯•æ¡ˆä¾‹å‡½æ•°
        function testCase1() {
            const commentInput = '["å°ä¿Š,çœ‹çœ‹è¿·å®«æ€ä¹ˆä¸ªäº‹,1748404172"]';
            const asrInput = '"çœ‹çœ‹è¿·å®«æ€ä¹ˆä¸ªäº‹"';
            
            testCorrelation(commentInput, asrInput, 'result1', 'æ¡ˆä¾‹1ç»“æœ');
        }

        function testCase2() {
            const commentInput = '["å°å‹‡æ­Œ,ä¸Šç­æ—èƒ½è¦å·…å³°æé€Ÿæœå—,1748404150"]';
            const asrInput = '"å°å‹‡æ­Œ,ä¸Šç­æ—èƒ½è¦å·…å³°æé€Ÿæœå—","å¯ä»¥çš„ï¼Œä¸Šç­æ—å½“ç„¶å¯ä»¥è¦å·…å³°æé€Ÿæœ"';
            
            testCorrelation(commentInput, asrInput, 'result2', 'æ¡ˆä¾‹2ç»“æœ');
        }

        function testCase3() {
            const commentInput = '["è°¢Father,ä½ æ€ä¹ˆæ²¡æ‰“è¿·å®«ï¼Ÿ,1748404100"]';
            const asrInput = '"ä½ æ€ä¹ˆæ²¡æ‰“è¿·å®«ï¼Ÿ"';
            
            testCorrelation(commentInput, asrInput, 'result3', 'æ¡ˆä¾‹3ç»“æœ');
        }

        function testCase4() {
            const commentInput = '["å¤å¤,æ–°æ–°æˆ˜ä»¤æœ‰æ²¡æœ‰å¥½çš„å•Šï¼Ÿ,1748404080"]';
            const asrInput = '"æ–°æ–°æˆ˜ä»¤æœ‰æ²¡æœ‰å¥½çš„"';
            
            testCorrelation(commentInput, asrInput, 'result4', 'æ¡ˆä¾‹4ç»“æœ');
        }

        function testCase5() {
            const commentInput = '["ç”¨æˆ·A,ä»€ä¹ˆæ—¶å€™æ›´æ–°æ–°ç‰ˆæœ¬ï¼Ÿ,1748404060"]';
            const asrInput = '"é¢„è®¡ä¸‹å‘¨ä¸‰ä¼šæœ‰æ–°ç‰ˆæœ¬æ›´æ–°"';
            
            testCorrelation(commentInput, asrInput, 'result5', 'æ¡ˆä¾‹5ç»“æœ');
        }

        function testCase6() {
            const commentInput = '["å°æ°,æ¸¸æˆä»€ä¹ˆæ—¶å€™å¼€æœï¼Ÿ,1748404040"]';
            const asrInput = '"æ¸¸æˆä»€ä¹ˆæ—¶å€™å¼€æœï¼Ÿ"';
            
            testCorrelation(commentInput, asrInput, 'result6', 'æ¡ˆä¾‹6ç»“æœ');
        }

        function testCase7() {
            const commentInput = '["æ°å“¥,è¿™ä¸ªè£…å¤‡æ€ä¹ˆè·å¾—ï¼Ÿ,1748404020"]';
            const asrInput = '"è¿™ä¸ªè£…å¤‡æ€ä¹ˆè·å¾—ï¼Ÿ"';
            
            testCorrelation(commentInput, asrInput, 'result7', 'æ¡ˆä¾‹7ç»“æœ');
        }

        function testCase8() {
            const commentInput = '["è€é“,å¤§ç¥,è¿™ä¸ªæŠ€èƒ½å‰å®³å—ï¼Ÿ,1748404000"]';
            const asrInput = '"è¿™ä¸ªæŠ€èƒ½å‰å®³å—ï¼Ÿ"';
            
            testCorrelation(commentInput, asrInput, 'result8', 'æ¡ˆä¾‹8ç»“æœ');
        }

        function testCase9() {
            const commentInput = '["å°å‹‡æ­Œ,ä¸Šç­æ—èƒ½è¦å·…å³°æé€Ÿæœå—,1748404150"]';
            const asrInput = '"åªè¦ç»æµä½“åšçš„å¥½å°±è¡Œè€Œä¸”äººçš„ä¸œè¥¿ä¿å€¼å•Šè¿™ä¹ˆå¤šå¹´ ä¸Šç­æ—èƒ½è¦å·…å³°æé€Ÿä½ è¿™ä¸ªä½ è¯´å·…å³°æœå‘—ä½ å¯ä»¥"';
            
            testCorrelation(commentInput, asrInput, 'result9', 'æ¡ˆä¾‹9ç»“æœ');
        }

        function testCorrelation(commentInput, asrInput, resultId, title) {
            console.log('========== ' + title + ' ==========');
            
            try {
                // è§£æASRæ–‡æœ¬
                const asrTexts = parseAsrText(asrInput);
                console.log('è§£æçš„ASRæ–‡æœ¬:', asrTexts);
                
                // è§£æè¯„è®ºæ–‡æœ¬
                const commentTexts = parseCommentText(commentInput);
                console.log('è§£æçš„è¯„è®ºæ–‡æœ¬:', commentTexts);
                
                // åˆ†æç›¸å…³æ€§
                const correlationAnalysis = analyzeCorrelation(asrTexts, commentTexts);
                console.log('ç›¸å…³æ€§åˆ†æç»“æœ:', correlationAnalysis);
                
                // æ˜¾ç¤ºç»“æœ
                displayTestResult(correlationAnalysis, resultId, title);
                
            } catch (error) {
                console.error('æµ‹è¯•å¤±è´¥:', error);
                const resultDiv = document.getElementById(resultId);
                resultDiv.className = 'test-result negative-result';
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `<h4>${title} - æµ‹è¯•å¤±è´¥</h4><p>é”™è¯¯: ${error.message}</p>`;
            }
        }

        function displayTestResult(analysis, resultId, title) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.style.display = 'block';
            
            if (analysis.hasCorrelation) {
                resultDiv.className = 'test-result';
                let html = `<h4>${title} - âœ… æ£€æµ‹åˆ°ç›¸å…³æ€§</h4>`;
                html += `<p><strong>åˆ¤æ–­åŸå› ï¼š</strong>${analysis.reasons.join('ã€')}</p>`;
                
                analysis.details.forEach((detail, index) => {
                    html += `<div style="margin: 10px 0; padding: 10px; background: #f0f8ff; border-radius: 4px;">`;
                    html += `<p><strong>è¯¦æƒ…${index + 1}ï¼š</strong></p>`;
                    html += `<p>ç±»å‹ï¼š${detail.type === 'reading' ? 'è¯»è¯„è®º' : 'å›ç­”è¯„è®º'}</p>`;
                    html += `<p>ASRæ–‡æœ¬ï¼š<code>${detail.asrText}</code></p>`;
                    html += `<p>è¯„è®ºæ–‡æœ¬ï¼š<code>${detail.commentText}</code></p>`;
                    html += `<p>ç›¸ä¼¼åº¦ï¼š${(detail.similarity * 100).toFixed(1)}%</p>`;
                    html += `<p>ç†ç”±ï¼š${detail.reason}</p>`;
                    html += `</div>`;
                });
                
                resultDiv.innerHTML = html;
            } else {
                resultDiv.className = 'test-result negative-result';
                resultDiv.innerHTML = `<h4>${title} - âŒ æœªæ£€æµ‹åˆ°ç›¸å…³æ€§</h4><p>ASRæ–‡æœ¬ä¸è¯„è®ºæ–‡æœ¬ä¹‹é—´æœªæ£€æµ‹åˆ°æ˜æ˜¾çš„ç›¸å…³æ€§ã€‚</p>`;
            }
        }

        function testAllCases() {
            testCase1();
            setTimeout(() => testCase2(), 100);
            setTimeout(() => testCase3(), 200);
            setTimeout(() => testCase4(), 300);
            setTimeout(() => testCase5(), 400);
            setTimeout(() => testCase6(), 500);
            setTimeout(() => testCase7(), 600);
            setTimeout(() => testCase8(), 700);
            setTimeout(() => testCase9(), 800);
        }

        function clearResults() {
            for (let i = 1; i <= 9; i++) {
                const resultDiv = document.getElementById('result' + i);
                resultDiv.style.display = 'none';
            }
        }
    </script>
</body>
</html> 